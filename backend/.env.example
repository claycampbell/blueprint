# =============================================================================
# CONNECT 2.0 - BACKEND ENVIRONMENT CONFIGURATION
# =============================================================================
# This is an example configuration file. Copy this to .env and update values.
# NEVER commit .env files to version control!
#
# For production, use Azure Key Vault or AWS Secrets Manager for sensitive values.
# =============================================================================

# -----------------------------------------------------------------------------
# SERVER CONFIGURATION
# -----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
HOST=localhost
API_VERSION=v1

# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION (PostgreSQL)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://connect_user:change_me_in_production@localhost:5432/connect_dev
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_SSL=false
DATABASE_LOGGING=true

# -----------------------------------------------------------------------------
# REDIS CACHE
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_TTL=300

# -----------------------------------------------------------------------------
# AUTHENTICATION & SECURITY
# -----------------------------------------------------------------------------
# JWT Signing Secret (REQUIRED - Generate with: openssl rand -base64 32)
JWT_SECRET=change-me-to-random-32-plus-character-string-in-production
JWT_ACCESS_TOKEN_EXPIRY=900        # 15 minutes (in seconds)
JWT_REFRESH_TOKEN_EXPIRY=604800    # 7 days (in seconds)

# Encryption key for sensitive data (REQUIRED - Generate with: openssl rand -base64 32)
DATA_ENCRYPTION_KEY=change-me-to-random-32-plus-character-encryption-key

# Password hashing (bcrypt)
BCRYPT_ROUNDS=12

# Session configuration
SESSION_TIMEOUT=3600               # 1 hour (in seconds)

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000        # 15 minutes
RATE_LIMIT_MAX_REQUESTS=1000
AUTH_RATE_LIMIT_MAX_ATTEMPTS=5

# -----------------------------------------------------------------------------
# CLOUD STORAGE (Choose one: AWS S3 or Azure Blob Storage)
# -----------------------------------------------------------------------------

# AWS S3 Configuration (if using AWS)
AWS_REGION=us-west-2
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
S3_BUCKET_NAME=connect-dev-documents
S3_BUCKET_REGION=us-west-2

# Azure Blob Storage Configuration (if using Azure)
AZURE_STORAGE_ACCOUNT=connectdevstorage
AZURE_STORAGE_KEY=your-azure-storage-key
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=connectdevstorage;AccountKey=your-key;EndpointSuffix=core.windows.net
AZURE_CONTAINER_NAME=documents

# -----------------------------------------------------------------------------
# EMAIL SERVICE (SendGrid)
# -----------------------------------------------------------------------------
SENDGRID_API_KEY=your-sendgrid-api-key
SENDGRID_FROM_EMAIL=noreply@connect.datapage.com
SENDGRID_FROM_NAME=Blueprint Connect 2.0

# SendGrid Template IDs
SENDGRID_TEMPLATE_WELCOME=d-abc123def456
SENDGRID_TEMPLATE_PASSWORD_RESET=d-abc123def457
SENDGRID_TEMPLATE_DRAW_APPROVED=d-abc123def458
SENDGRID_TEMPLATE_INSPECTION_REMINDER=d-abc123def459
SENDGRID_TEMPLATE_LOAN_FUNDED=d-abc123def460

# Webhook secret for SendGrid events
SENDGRID_WEBHOOK_SECRET=your-sendgrid-webhook-secret

# -----------------------------------------------------------------------------
# SMS SERVICE (Twilio)
# -----------------------------------------------------------------------------
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+15551234567

# Webhook secret for Twilio
TWILIO_WEBHOOK_SECRET=your-twilio-webhook-secret

# -----------------------------------------------------------------------------
# E-SIGNATURE INTEGRATION (DocuSign)
# -----------------------------------------------------------------------------
DOCUSIGN_API_BASE_URL=https://demo.docusign.net/restapi
DOCUSIGN_ACCOUNT_ID=your-docusign-account-id
DOCUSIGN_INTEGRATION_KEY=your-integration-key
DOCUSIGN_USER_ID=your-user-id
DOCUSIGN_PRIVATE_KEY_PATH=/path/to/private-key.pem
DOCUSIGN_WEBHOOK_SECRET=your-docusign-webhook-secret

# Authentisign (Alternative)
AUTHENTISIGN_API_BASE_URL=https://api.authentisign.com/v1
AUTHENTISIGN_API_KEY=your-authentisign-api-key
AUTHENTISIGN_WEBHOOK_SECRET=your-authentisign-webhook-secret

# -----------------------------------------------------------------------------
# AZURE DOCUMENT INTELLIGENCE (Form Recognizer)
# -----------------------------------------------------------------------------
AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT=https://your-resource.cognitiveservices.azure.com
AZURE_DOCUMENT_INTELLIGENCE_KEY=your-azure-document-intelligence-key
AZURE_DOCUMENT_INTELLIGENCE_API_VERSION=2023-07-31

# Custom model IDs
AZURE_DOCUMENT_INTELLIGENCE_SURVEY_MODEL=blueprint-survey
AZURE_DOCUMENT_INTELLIGENCE_TITLE_MODEL=blueprint-title-report
AZURE_DOCUMENT_INTELLIGENCE_ARBORIST_MODEL=blueprint-arborist-report
AZURE_DOCUMENT_INTELLIGENCE_PERMIT_MODEL=blueprint-permit

# -----------------------------------------------------------------------------
# BPO LEGACY SYSTEM INTEGRATION (Days 1-90)
# -----------------------------------------------------------------------------
BPO_API_URL=https://api.blueprintonline.com
BPO_API_KEY=your-bpo-api-key
BPO_SYNC_ENABLED=true
BPO_SYNC_INTERVAL_HOURS=24

# -----------------------------------------------------------------------------
# ACCOUNTING SYSTEM INTEGRATION (QuickBooks Online example)
# -----------------------------------------------------------------------------
QUICKBOOKS_CLIENT_ID=your-quickbooks-client-id
QUICKBOOKS_CLIENT_SECRET=your-quickbooks-client-secret
QUICKBOOKS_REDIRECT_URI=https://connect.datapage.com/oauth/quickbooks/callback
QUICKBOOKS_ENVIRONMENT=sandbox                    # sandbox or production
QUICKBOOKS_REALM_ID=your-company-realm-id

# -----------------------------------------------------------------------------
# MONITORING & LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=debug                                   # debug, info, warn, error
LOG_FORMAT=json                                   # json or pretty

# Sentry (Error Tracking)
SENTRY_DSN=your-sentry-dsn
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1                     # 10% of transactions

# Datadog (Monitoring & APM)
DATADOG_API_KEY=your-datadog-api-key
DATADOG_APP_KEY=your-datadog-app-key
DATADOG_SERVICE_NAME=connect2-backend
DATADOG_ENV=development

# Application Insights (Azure alternative)
APPINSIGHTS_INSTRUMENTATIONKEY=your-instrumentation-key
APPINSIGHTS_CONNECTION_STRING=InstrumentationKey=your-key;IngestionEndpoint=https://...

# -----------------------------------------------------------------------------
# MESSAGE QUEUE (Choose one: RabbitMQ, AWS SQS, or Redis Streams)
# -----------------------------------------------------------------------------

# RabbitMQ
RABBITMQ_URL=amqp://guest:guest@localhost:5672
RABBITMQ_EXCHANGE=connect2-events

# AWS SQS (if using AWS)
AWS_SQS_QUEUE_URL=https://sqs.us-west-2.amazonaws.com/123456789012/connect2-queue
AWS_SQS_REGION=us-west-2

# -----------------------------------------------------------------------------
# SECRETS MANAGEMENT
# -----------------------------------------------------------------------------

# Azure Key Vault (if using Azure)
KEY_VAULT_URL=https://connect2-vault.vault.azure.net/
KEY_VAULT_CLIENT_ID=your-azure-client-id
KEY_VAULT_CLIENT_SECRET=your-azure-client-secret
KEY_VAULT_TENANT_ID=your-azure-tenant-id

# AWS Secrets Manager (if using AWS)
AWS_SECRETS_REGION=us-west-2

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
FEATURE_BPO_INTEGRATION=true
FEATURE_IPAD_SYNC=false                           # Enable in Days 91-180
FEATURE_ACCOUNTING_INTEGRATION=false              # Enable in Days 91-180
FEATURE_AI_DOCUMENT_EXTRACTION=true
FEATURE_MFA_REQUIRED=false                        # Enable in production

# -----------------------------------------------------------------------------
# EXTERNAL APIs
# -----------------------------------------------------------------------------

# Public API Base URL (for webhooks callbacks)
PUBLIC_API_URL=https://connect.datapage.com/api/v1

# Portal URL (for email links)
PORTAL_URL=https://portal.blueprint.com

# -----------------------------------------------------------------------------
# PERFORMANCE & OPTIMIZATION
# -----------------------------------------------------------------------------

# Query timeout (milliseconds)
DATABASE_QUERY_TIMEOUT=30000

# File upload limits
MAX_FILE_SIZE_MB=50
MAX_PHOTO_SIZE_MB=10

# Pagination defaults
DEFAULT_PAGE_SIZE=25
MAX_PAGE_SIZE=100

# -----------------------------------------------------------------------------
# DEVELOPMENT & DEBUG
# -----------------------------------------------------------------------------

# Seed database with test data
SEED_DATABASE=false

# Enable SQL query logging
DEBUG_SQL=false

# Disable authentication (NEVER in production!)
DISABLE_AUTH=false
